<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.12">
  <compounddef id="md__r_e_a_d_m_e" kind="page">
    <compoundname>md_README</compoundname>
    <title>Generic Build Instructions</title>
    <detaileddescription>
<para><heading level="4">Setup</heading>
</para><para>To build Google Test and your tests that use it, you need to tell your build system where to find its headers and source files. The exact way to do it depends on which build system you use, and is usually straightforward.</para><para><heading level="4">Build</heading>
</para><para>Suppose you put Google Test in directory <computeroutput>${GTEST_DIR}</computeroutput>. To build it, create a library build target (or a project as called by Visual Studio and Xcode) to compile <verbatim>${GTEST_DIR}/src/gtest-all.cc
</verbatim></para><para>with <computeroutput>${GTEST_DIR}/include</computeroutput> in the system header search path and <computeroutput>${GTEST_DIR}</computeroutput> in the normal header search path. Assuming a Linux-like system and gcc, something like the following will do: <verbatim>g++ -isystem ${GTEST_DIR}/include -I${GTEST_DIR} \
    -pthread -c ${GTEST_DIR}/src/gtest-all.cc
ar -rv libgtest.a gtest-all.o
</verbatim></para><para>(We need <computeroutput>-pthread</computeroutput> as Google Test uses threads.)</para><para>Next, you should compile your test source file with <computeroutput>${GTEST_DIR}/include</computeroutput> in the system header search path, and link it with gtest and any other necessary libraries: <verbatim>g++ -isystem ${GTEST_DIR}/include -pthread path/to/your_test.cc libgtest.a \
    -o your_test
</verbatim></para><para>As an example, the make/ directory contains a Makefile that you can use to build Google Test on systems where GNU make is available (e.g. Linux, Mac OS X, and Cygwin). It doesn&apos;t try to build Google Test&apos;s own tests. Instead, it just builds the Google Test library and a sample test. You can use it as a starting point for your own build script.</para><para>If the default settings are correct for your environment, the following commands should succeed: <verbatim>cd ${GTEST_DIR}/make
make
./sample1_unittest
</verbatim></para><para>If you see errors, try to tweak the contents of <computeroutput>make/Makefile</computeroutput> to make them go away. There are instructions in <computeroutput>make/Makefile</computeroutput> on how to do it.</para><para><heading level="3">Using CMake</heading>
</para><para>Google Test comes with a CMake build script ( <ulink url="CMakeLists.txt">CMakeLists.txt</ulink>) that can be used on a wide range of platforms (&quot;C&quot; stands for cross-platform.). If you don&apos;t have CMake installed already, you can download it for free from <ulink url="http://www.cmake.org/">http://www.cmake.org/</ulink>.</para><para>CMake works by generating native makefiles or build projects that can be used in the compiler environment of your choice. The typical workflow starts with: <verbatim>mkdir mybuild       # Create a directory to hold the build output.
cd mybuild
cmake ${GTEST_DIR}  # Generate native build scripts.
</verbatim></para><para>If you want to build Google Test&apos;s samples, you should replace the last command with <verbatim>cmake -Dgtest_build_samples=ON ${GTEST_DIR}
</verbatim></para><para>If you are on a *nix system, you should now see a Makefile in the current directory. Just type &apos;make&apos; to build gtest.</para><para>If you use Windows and have Visual Studio installed, a <computeroutput>gtest.sln</computeroutput> file and several <computeroutput>.vcproj</computeroutput> files will be created. You can then build them using Visual Studio.</para><para>On Mac OS X with Xcode installed, a <computeroutput>.xcodeproj</computeroutput> file will be generated.</para><para><heading level="3">Legacy Build Scripts</heading>
</para><para>Before settling on CMake, we have been providing hand-maintained build projects/scripts for Visual Studio, Xcode, and Autotools. While we continue to provide them for convenience, they are not actively maintained any more. We highly recommend that you follow the instructions in the previous two sections to integrate Google Test with your existing build system.</para><para>If you still need to use the legacy build scripts, here&apos;s how:</para><para>The msvc\ folder contains two solutions with Visual C++ projects. Open the <computeroutput>gtest.sln</computeroutput> or <computeroutput>gtest-md.sln</computeroutput> file using Visual Studio, and you are ready to build Google Test the same way you build any Visual Studio project. Files that have names ending with -md use DLL versions of Microsoft runtime libraries (the /MD or the /MDd compiler option). Files without that suffix use static versions of the runtime libraries (the /MT or the /MTd option). Please note that one must use the same option to compile both gtest and the test code. If you use Visual Studio 2005 or above, we recommend the -md version as /MD is the default for new projects in these versions of Visual Studio.</para><para>On Mac OS X, open the <computeroutput>gtest.xcodeproj</computeroutput> in the <computeroutput>xcode/</computeroutput> folder using Xcode. Build the &quot;gtest&quot; target. The universal binary framework will end up in your selected build directory (selected in the Xcode &quot;Preferences...&quot; -&gt; &quot;Building&quot; pane and defaults to xcode/build). Alternatively, at the command line, enter: <verbatim>xcodebuild
</verbatim></para><para>This will build the &quot;Release&quot; configuration of gtest.framework in your default build location. See the &quot;xcodebuild&quot; man page for more information about building different configurations and building in different locations.</para><para>If you wish to use the Google Test Xcode project with Xcode 4.x and above, you need to either:</para><para><itemizedlist>
<listitem><para>update the SDK configuration options in xcode/Config/General.xconfig. Comment options <computeroutput>SDKROOT</computeroutput>, <computeroutput>MACOS_DEPLOYMENT_TARGET</computeroutput>, and <computeroutput>GCC_VERSION</computeroutput>. If you choose this route you lose the ability to target earlier versions of MacOS X.</para></listitem><listitem><para>Install an SDK for an earlier version. This doesn&apos;t appear to be supported by Apple, but has been reported to work (<ulink url="http://stackoverflow.com/questions/5378518">http://stackoverflow.com/questions/5378518</ulink>).</para></listitem></itemizedlist>
</para><para><heading level="3">Tweaking Google Test</heading>
</para><para>Google Test can be used in diverse environments. The default configuration may not work (or may not work well) out of the box in some environments. However, you can easily tweak Google Test by defining control macros on the compiler command line. Generally, these macros are named like <computeroutput>GTEST_XYZ</computeroutput> and you define them to either 1 or 0 to enable or disable a certain feature.</para><para>We list the most frequently used macros below. For a complete list, see file <ulink url="include/gtest/internal/gtest-port.h">include/gtest/internal/gtest-port.h</ulink>.</para><para><heading level="3">Choosing a TR1 Tuple Library</heading>
</para><para>Some Google Test features require the C++ Technical Report 1 (TR1) tuple library, which is not yet available with all compilers. The good news is that Google Test implements a subset of TR1 tuple that&apos;s enough for its own need, and will automatically use this when the compiler doesn&apos;t provide TR1 tuple.</para><para>Usually you don&apos;t need to care about which tuple library Google Test uses. However, if your project already uses TR1 tuple, you need to tell Google Test to use the same TR1 tuple library the rest of your project uses, or the two tuple implementations will clash. To do that, add <verbatim>-DGTEST_USE_OWN_TR1_TUPLE=0
</verbatim></para><para>to the compiler flags while compiling Google Test and your tests. If you want to force Google Test to use its own tuple library, just add <verbatim>-DGTEST_USE_OWN_TR1_TUPLE=1
</verbatim></para><para>to the compiler flags instead.</para><para>If you don&apos;t want Google Test to use tuple at all, add <verbatim>-DGTEST_HAS_TR1_TUPLE=0
</verbatim></para><para>and all features using tuple will be disabled.</para><para><heading level="3">Multi-threaded Tests</heading>
</para><para>Google Test is thread-safe where the pthread library is available. After <computeroutput>#include &quot;gtest/gtest.h&quot;</computeroutput>, you can check the <computeroutput>GTEST_IS_THREADSAFE</computeroutput> macro to see whether this is the case (yes if the macro is <computeroutput>#defined</computeroutput> to 1, no if it&apos;s undefined.).</para><para>If Google Test doesn&apos;t correctly detect whether pthread is available in your environment, you can force it with <verbatim>-DGTEST_HAS_PTHREAD=1
</verbatim></para><para>or <verbatim>-DGTEST_HAS_PTHREAD=0
</verbatim></para><para>When Google Test uses pthread, you may need to add flags to your compiler and/or linker to select the pthread library, or you&apos;ll get link errors. If you use the CMake script or the deprecated Autotools script, this is taken care of for you. If you use your own build script, you&apos;ll need to read your compiler and linker&apos;s manual to figure out what flags to add.</para><para><heading level="3">As a Shared Library (DLL)</heading>
</para><para>Google Test is compact, so most users can build and link it as a static library for the simplicity. You can choose to use Google Test as a shared library (known as a DLL on Windows) if you prefer.</para><para>To compile <emphasis>gtest</emphasis> as a shared library, add <verbatim>-DGTEST_CREATE_SHARED_LIBRARY=1
</verbatim></para><para>to the compiler flags. You&apos;ll also need to tell the linker to produce a shared library instead - consult your linker&apos;s manual for how to do it.</para><para>To compile your <emphasis>tests</emphasis> that use the gtest shared library, add <verbatim>-DGTEST_LINKED_AS_SHARED_LIBRARY=1
</verbatim></para><para>to the compiler flags.</para><para>Note: while the above steps aren&apos;t technically necessary today when using some compilers (e.g. GCC), they may become necessary in the future, if we decide to improve the speed of loading the library (see <ulink url="http://gcc.gnu.org/wiki/Visibility">http://gcc.gnu.org/wiki/Visibility</ulink> for details). Therefore you are recommended to always add the above flags when using Google Test as a shared library. Otherwise a future release of Google Test may break your build script.</para><para><heading level="3">Avoiding Macro Name Clashes</heading>
</para><para>In C++, macros don&apos;t obey namespaces. Therefore two libraries that both define a macro of the same name will clash if you <computeroutput>#include</computeroutput> both definitions. In case a Google Test macro clashes with another library, you can force Google Test to rename its macro to avoid the conflict.</para><para>Specifically, if both Google Test and some other code define macro FOO, you can add <verbatim>-DGTEST_DONT_DEFINE_FOO=1
</verbatim></para><para>to the compiler flags to tell Google Test to change the macro&apos;s name from <computeroutput>FOO</computeroutput> to <computeroutput>GTEST_FOO</computeroutput>. Currently <computeroutput>FOO</computeroutput> can be <computeroutput>FAIL</computeroutput>, <computeroutput>SUCCEED</computeroutput>, or <computeroutput>TEST</computeroutput>. For example, with <computeroutput>-DGTEST_DONT_DEFINE_TEST=1</computeroutput>, you&apos;ll need to write <verbatim>GTEST_TEST(SomeTest, DoesThis) { ... }
</verbatim></para><para>instead of <verbatim>TEST(SomeTest, DoesThis) { ... }
</verbatim></para><para>in order to define a test.</para><para><heading level="2">Developing Google Test</heading>
</para><para>This section discusses how to make your own changes to Google Test.</para><para><heading level="3">Testing Google Test Itself</heading>
</para><para>To make sure your changes work as intended and don&apos;t break existing functionality, you&apos;ll want to compile and run Google Test&apos;s own tests. For that you can use CMake: <verbatim>mkdir mybuild
cd mybuild
cmake -Dgtest_build_tests=ON ${GTEST_DIR}
</verbatim></para><para>Make sure you have Python installed, as some of Google Test&apos;s tests are written in Python. If the cmake command complains about not being able to find Python (<computeroutput>Could NOT find PythonInterp (missing: PYTHON_EXECUTABLE)</computeroutput>), try telling it explicitly where your Python executable can be found: <verbatim>cmake -DPYTHON_EXECUTABLE=path/to/python -Dgtest_build_tests=ON ${GTEST_DIR}
</verbatim></para><para>Next, you can build Google Test and all of its own tests. On *nix, this is usually done by &apos;make&apos;. To run the tests, do <verbatim>make test
</verbatim></para><para>All tests should pass.</para><para>Normally you don&apos;t need to worry about regenerating the source files, unless you need to modify them. In that case, you should modify the corresponding .pump files instead and run the pump.py Python script to regenerate them. You can find pump.py in the <ulink url="scripts/">scripts/</ulink> directory. Read the Pump manual for how to use it. </para>    </detaileddescription>
  </compounddef>
</doxygen>
